
{% extends "base.html" %}
{% block content %}
  <h2 class="h4">관리자 대시보드</h2>
  <form class="card form" method="post" enctype="multipart/form-data">
    <h3 class="h5">영화 추가</h3>
    <label>제목
      <input name="title" placeholder="영화 제목" required>
    </label>
    <label>상영일
      <input type="date" name="show_date" required>
    </label>
    <label>포스터 (png/jpg/webp)
      <input type="file" name="poster" accept=".png,.jpg,.jpeg,.webp">
    </label>
    <button class="btn">추가</button>
  </form>

  <div class="card">
    <h3 class="h5">영화 목록</h3>
    <table class="table">
      <thead><tr><th>제목</th><th>상영일</th><th>포스터</th><th>예약수</th><th>관리</th></tr></thead>
      <tbody>
      {% for m in movies %}
        <tr>
          <td>{{ m["title"] }}</td>
          <td>{{ m["show_date"] }}</td>
          <td>{% if m["poster_path"] %}<a href="{{ '/' + m['poster_path'] }}" target="_blank">보기</a>{% else %}-{% endif %}</td>
          <td>{{ m["rcount"] }}</td>
          <td>
            <a class="btn small" href="{{ url_for('admin_reservations', movie_id=m['id']) }}">예약 보기</a>
            <a class="btn small outline" href="{{ url_for('admin_export', movie_id=m['id']) }}">CSV 내보내기</a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
