{% extends "base.html" %}
{% block content %}
{% set movie = get_movie(t['movie_id']) %}
{% set ticket_type = t['type'] %}
{% set is_group = ticket_type == 'group' %}
{% set is_teacher = ticket_type == 'teacher' %}
{% set is_normal = ticket_type == 'normal' %}

<section class="ticket-hero">
  <img src="{{ (movie['poster'] if movie and movie.get('poster') else url_for('static', filename='images/poster-placeholder.jpg')) }}"
       alt="{{ movie['title'] if movie else 'ì˜í™”' }}">
  <div class="title-wrap">
    <p class="eyebrow">í™”ë©´ì„ ìº¡ì³í•˜ì—¬ ìƒì˜ê´€ ì…ì¥ ì‹œ ë³´ì—¬ì£¼ì„¸ìš”.</p>
    <h1 class="title">{{ movie['title'] if movie else '' }}</h1>
  </div>
</section>

<article class="ticket-sheet">
  {% if is_normal %}
    <div class="sticker">TICKET</div>
  {% elif is_group %}
    <div class="sticker gold">TICKET</div>
  {% else %}
    <div class="sticker prime">PRIME</div>
  {% endif %}

  <header class="sheet-head">
    <h2 class="sheet-title">{{ movie['title'] if movie else '' }}</h2>
    <span class="type-chip {% if is_normal %}type-red{% elif is_group %}type-gold{% else %}type-prime{% endif %}">
      {% if is_normal %}Red(ì¼ë°˜){% elif is_group %}Gold(ë‹¨ì²´){% else %}Prime(êµì‚¬){% endif %}
    </span>
  </header>

  <div class="kv" style="margin-top:12px">
    {% if is_group %}
      <div class="item"><b>í˜¸ìŠ¤íŠ¸</b><span>{{ t['student_id'] }} {{ t['student_name'] }}</span></div>
    {% elif is_normal %}
      <div class="item"><b>ì˜ˆì•½ì</b><span>{{ t['student_id'] }} {{ t['student_name'] }}</span></div>
    {% endif %}

    {% if is_group and t['member_names'] %}
      <div class="divider"></div>
      <div class="stack">
        <b class="k">ë™ë°˜ì ëª…ë‹¨ ({{ (t['group_size'] or 1) - 1 }}ëª…)</b>
        <div class="card-soft" style="white-space:pre-line">
          {{ t['member_names'] }}
        </div>
      </div>
    {% endif %}

    <div class="item"><b>ìƒì˜ë‚ ì§œ</b><span>{{ t['date'] }}</span></div>
    <div class="item"><b>ì˜ˆì•½ë²ˆí˜¸</b><span>{{ t['id'] }}</span></div>
    <div class="item"><b>ìƒì˜ì‹œê°„</b><span>{{ t['time'] }}</span></div>
    <div class="item"><b>ìƒì˜ê´€</b><span>{{ t['hall'] }}</span></div>

    {% if is_group %}
      <div class="item"><b>ë‹¨ì²´ëª… / ì¸ì›</b><span>{{ t['group_name'] or '-' }} / {{ t['group_size'] or 0 }}ëª…</span></div>
    {% elif is_teacher %}
      <div class="item"><b>ë‹´ë‹¹ êµì‚¬</b><span>{{ t['teacher_name'] or '-' }} / {{ t['class_info'] or '' }}</span></div>
    {% endif %}
  </div>

  <div class="divider"></div>

  <div class="meta-eyebrow" style="margin-bottom:8px">
    <span>Nyca ì˜µì…˜</span><span class="meta-line"></span>
  </div>

  <div class="t-actions">
    <button
      class="pill pill-soft"
      data-confirm
      data-title="ì˜ˆì•½ ì·¨ì†Œ"
      data-message="ì •ë§ ì˜ˆì•½ì„ ì·¨ì†Œí• ê¹Œìš”? ì·¨ì†Œ í›„ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
      data-endpoint="{{ url_for('ticket_delete', tid=t['id'], next='home') }}"
      data-method="POST">
      ì˜ˆì•½ ì·¨ì†Œ
    </button>


    <a class="pill pill-soft" href="{{ url_for('movie_info', movie_id=t['movie_id']) }}">ì˜í™” ì •ë³´</a>
    <a class="pill pill-soft" href="{{ url_for('notices') }}">ìƒì˜ê´€ ê·œì¹™</a>

    <a class="pill pill-soft" href="{{ url_for('index') }}">ğŸ  í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
  </div>
</article>
{% endblock %}
